{~add-ons/Creep_War/macros/Macros.cfg}
#define update_score_3
	[print]
		text="$kill_W| : $kill_S| : $kill_E|"
		size=24
		red=255
		duration=110
	[/print]
	[label]
		x=16
		y=14
		text="$kill_W|
$gold_W|g"
	[/label]
	[label]
		x=18
		y=14
		text="$kill_E|
$gold_E|g"
	[/label]
	[label]
		x=17
		y=15
		text="$kill_S|
$gold_S|g"
	[/label]
#enddef

#define frac_add_hp_guard kill team
	[set_variable]
		name={kill}_frac
		add=0.5
	[/set_variable]
	[if]
		[variable]
			name={kill}_frac
			greater_than_equal_to=1
		[/variable]
		[then]
			[set_variable]
				name={kill}_frac
				add=-1
			[/set_variable]
			[object]
				silent=yes
				[filter]
					id=CW_Guard_{team}1
				[/filter]
				[effect]
					apply_to=hitpoints
					increase_total=1
					increase=1
				[/effect]
			[/object]
			[object]
				silent=yes
				[filter]
					id=CW_Guard_{team}2
				[/filter]
				[effect]
					apply_to=hitpoints
					increase_total=1
					increase=1
				[/effect]
			[/object]
			[set_variable]
				name=guard_{team}_plus_hitpoints
				add=1
			[/set_variable]
		[/then]
	[/if]
#enddef

#define hero_die_3 enemy1 enemy2 creepside1 enemy3 enemy4 creepside2 kill1 team1 kill2 team2 side
	[event]
		name=die
		first_time_only=no
		[filter]
			side={side}
			canrecruit=yes
		[/filter]
		[object]
			silent=yes
			[effect]
				apply_to=hitpoints
				heal_full=yes
			[/effect]
			[effect]
				apply_to=status
				remove=poisoned
			[/effect]
			[effect]
				apply_to=status
				remove=slowed
			[/effect]
		[/object]
		[if]
			[variable]
				name=second_unit.side
				equals={enemy1}
			[/variable]
			[or]
				[variable]
					name=second_unit.side
					equals={enemy2}
				[/variable]
			[/or]
			[or]
				[variable]
					name=second_unit.side
					equals={creepside1}
				[/variable]
			[/or]
			[then]
				[gold]
					side={enemy1}
					amount=20
				[/gold]
				[gold]
					side={enemy2}
					amount=20
				[/gold]
				[set_variable]
					name=gold_{team1}
					add=20
				[/set_variable]
				[set_variable]
					name={kill1}
					add=3
				[/set_variable]
				[gold]
					side={enemy3}
					amount=10
				[/gold]
				[gold]
					side={enemy2}
					amount=10
				[/gold]
				[set_variable]
					name=gold_{team2}
					add=10
				[/set_variable]
				[set_variable]
					name={kill2}
					add=1.5
				[/set_variable]
				[object]
					silent=yes
					[filter]
						id=CW_Guard_{team1}1
					[/filter]
					[effect]
						apply_to=hitpoints
						increase_total=3
						increase=3
					[/effect]
				[/object]
				[object]
					silent=yes
					[filter]
						id=CW_Guard_{team1}2
					[/filter]
					[effect]
						apply_to=hitpoints
						increase_total=3
						increase=3
					[/effect]
				[/object]
				[set_variable]
					name=guard_{team1}_plus_hitpoints
					add=3
				[/set_variable]
				[object]
					silent=yes
					[filter]
						id=CW_Guard_{team2}1
					[/filter]
					[effect]
						apply_to=hitpoints
						increase_total=1
						increase=1
					[/effect]
				[/object]
				[object]
					silent=yes
					[filter]
						id=CW_Guard_{team2}2
					[/filter]
					[effect]
						apply_to=hitpoints
						increase_total=1
						increase=1
					[/effect]
				[/object]
				[set_variable]
					name=guard_{team2}_plus_hitpoints
					add=1
				[/set_variable]
				{frac_add_hp_guard {kill2} {team2}}
			[/then]
		[/if]
		[if]
			[variable]
				name=second_unit.side
				equals={enemy3}
			[/variable]
			[or]
				[variable]
					name=second_unit.side
					equals={enemy4}
				[/variable]
			[/or]
			[or]
				[variable]
					name=second_unit.side
					equals={creepside2}
				[/variable]
			[/or]
			[then]
				[gold]
					side={enemy3}
					amount=20
				[/gold]
				[gold]
					side={enemy4}
					amount=20
				[/gold]
				[set_variable]
					name=gold_{team2}
					add=20
				[/set_variable]
				[set_variable]
					name={kill2}
					add=3
				[/set_variable]
				[gold]
					side={enemy1}
					amount=10
				[/gold]
				[gold]
					side={enemy2}
					amount=10
				[/gold]
				[set_variable]
					name=gold_{team1}
					add=10
				[/set_variable]
				[set_variable]
					name={kill1}
					add=1.5
				[/set_variable]
				[object]
					silent=yes
					[filter]
						id=CW_Guard_{team2}1
					[/filter]
					[effect]
						apply_to=hitpoints
						increase_total=3
						increase=3
					[/effect]
				[/object]
				[object]
					silent=yes
					[filter]
						id=CW_Guard_{team2}2
					[/filter]
					[effect]
						apply_to=hitpoints
						increase_total=3
						increase=3
					[/effect]
				[/object]
				[set_variable]
					name=guard_{team2}_plus_hitpoints
					add=3
				[/set_variable]
				[object]
					silent=yes
					[filter]
						id=CW_Guard_{team1}1
					[/filter]
					[effect]
						apply_to=hitpoints
						increase_total=1
						increase=1
					[/effect]
				[/object]
				[object]
					silent=yes
					[filter]
						id=CW_Guard_{team1}2
					[/filter]
					[effect]
						apply_to=hitpoints
						increase_total=1
						increase=1
					[/effect]
				[/object]
				[set_variable]
					name=guard_{team1}_plus_hitpoints
					add=1
				[/set_variable]
				{frac_add_hp_guard {kill1} {team1}}
			[/then]
		[/if]
		[store_unit]
			[filter]
				side={side}
				canrecruit=yes
			[/filter]
			variable=dead_hero_{side}
			kill=yes
		[/store_unit]
		[set_variable]
			name=hero_{side}
			value=dead_wait
		[/set_variable]
		{update_score_3}
	[/event]
#enddef
